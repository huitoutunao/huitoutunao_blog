# 如何系统优化页面

## 前言

页面优化就是让页面响应速度更快，由于一个页面在它不同的阶段，所侧重的关注点是不一样的，所以如果我们要讨论页面优化，就要分析一个页面生存周期的不同阶段：加载、交互和关闭。

## 加载阶段

这个阶段是指从请求到渲染出完整页面的过程。

**影响因素如下：**

1. 关键资源个数。
2. 关键资源大小。
3. 请求关键资源需要多少个 RTT。

关键资源是指 HTML、JavaScript 和 CSS。

RTT 就是这里的往返时延。它是网络中一个重要的性能指标，表示从发送端发送数据开始，到发送端收到来自接收端的确认，总共经历的时延。通常 1 个 HTTP 的数据包在 14KB 左右，所以 1 个 0.1M 的页面就需要拆分成 8 个包来传输了，也就是说需要 8 个 RTT。

**对应优化如下：**

- 如何减少关键资源个数？

1、JavaScript 和 CSS 改成内联的形式。

2、如果 JavaScript 代码没有 DOM 或者 CSSOM 的操作，则可以改成 async 或者 defer 属性。

3、对于 CSS，如果不是在构建页面之前加载的，则可以添加媒体取消阻止显现的标志 [disabled](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/link#attr-disabled)。

- 如何降低关键资源大小？

1、压缩 CSS 和 JavaScript 资源。

2、移除 HTML、CSS 和 JavaScript 无用注释。

- 如何减少关键资源的 RTT 数？

1、CDN。

2、结合前面两种方案。

## 交互阶段