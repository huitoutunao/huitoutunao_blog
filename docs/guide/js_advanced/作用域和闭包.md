# 作用域和闭包

## 什么是作用域

在理解作用域前，我们先来简单了解一下 JavaScript 引擎运行机制是怎么样的？

举个例子：
```js
var bar = 1
```

JavaScript 引擎在执行上面那句代码前，须要对它进行编译。编译时，在当前作用域查找是否有 bar 这个变量，如果没有就声明一个新的变量 bar，否则就忽略。运行时，在当前作用域查找是否有 bar 这个变量，如果能够找到就对它赋值 1，否则就抛出异常。

再举个例子：
```js
var b = 1

function foo (a) {
    console.log(a + b)
}

foo(2)
```

JavaScript 引擎在执行上面那段代码过程如下：

编译时，声明 b 变量、foo 函数和 foo 函数的形参 a。  
执行时，首先在 foo 当前函数作用域查找变量 a 和 b，b 未在当前作用域找到，便跑到上一层作用域去查找，抵达顶层（全局作用域）后停止查找。

**因此作用域是用于确定在何处以及如何查找变量，即确定当前执行代码能够触及变量的边界。**

## 词法作用域

JavaScript 采用的是词法作用域，换句话说就是在写代码时将变量和函数写在哪里来决定的。

举个例子：
```js
var name = 'huitoutunao'

function student () {
    console.log(name)
}

function student2 () {
    var name = 'huitoutunao2'
    student()
}

student2() // 打印结果：huitoutunao
```

进一步得出结论：无论函数在哪里被调用，也无论如何被调用，它的词法作用域都只由函数声明时所处的位置决定。
