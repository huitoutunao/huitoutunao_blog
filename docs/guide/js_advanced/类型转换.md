# 类型转换

将值从一种类型转换为另一种类型通常称为类型转换。

JavaScript 的类型转换既简单又复杂，从 JavaScript 诞生之日起一直是饱受争议的话题。

截止写稿日期，JavaScript 共有八种数据类型，分别是：Undefined、Null、Boolean、Number、String、Object、Symbol、BigInt。

## 抽象值操作

首先我们需要掌握字符串、数字和布尔值之间类型转换的基本规则。ES5 规范第 9 节中定义了一些“抽象操作”（即“仅供内部使用的操作”）和转换规则。这里主要介绍 ToString([英文](https://262.ecma-international.org/5.1/#sec-9.8)/[中文](https://yanhaijing.com/es5/#111))、ToNumber([英文](https://262.ecma-international.org/5.1/#sec-9.3)/[中文](https://yanhaijing.com/es5/#105)) 和 ToBoolean([英文](https://262.ecma-international.org/5.1/#sec-9.2)/[中文](https://yanhaijing.com/es5/#104))，附带介绍一下 ToPrimitive([英文](https://262.ecma-international.org/5.1/#sec-9.1)/[中文](https://yanhaijing.com/es5/#103))。

### ToString

它负责处理非字符串到字符串的强制类型转换。转换规则见下表：

| 参数类型 | 结果 |
| ---- | ---- |
| Undefined | "undefined" |
| Null | "null" |
| Boolean | 如果参数是 true，那么结果为 "true"。<br/>如果参数是 false，那么结果为 "false"。 |
| Number | 这个比较复杂，见下面例子 |
| String | 返回输入的参数（不转换） |
| Object | 分两步走：<br/> 1、primValue = ToPrimitive(input, String)。<br/>2、返回ToNumber(primValue)。 |

传入 Number 类型时，输出结果：
```js
var negative_0 = -0
var negative_Infinity = -Infinity
var a = 3.14 * 10000 * 10000 * 10000 * 10000 * 10000 * 10000

console.log(String(NaN)) // NaN
console.log(String(negative_0)) // 0
console.log(String(0)) // 0
console.log(String(Infinity)) // Infinity
console.log(String(negative_Infinity)) // -Infinity
console.log(String(a)) // 3.14e24
console.log(String(10)) // 10
```

至于传入 Object 类型时，输出结果的分析，我们等介绍完 ToPrimitive 后再细说，这里简单提及两个：
1. 对普通对象来说，除非自行定义，否则 `toString()` 返回内部属性 [[Class]] 的值。如果对象本身有定义 toString() 方法，那么字符串化时就会调用该方法并使用其返回值。
```js
// demo1
var o = { name: 'xiaoming' }
console.log(o.toString()) // [object Object]

// demo2
var o = {
    name: 'xiaoming',
    toString: function () {
        return 'type string'
    }
}
console.log(o.toString()) // type string
```

2. 数组默认的 `toString()` 方法经过了重新定义，将所有单元字符串化后再用“,”连接起来。`toString()` 可以被显示调用，或者在需要字符串化时自动调用。
```js
var a = [1, 2, 3]
console.log(a.toString()) // 1,2,3
```

#### JSON.stringify

`JSON.stringify()` 方法在将 JSON 对象序列化为字符串时也用到了 `ToString`，所以 JSON 字符串化并非严格意义上的强制类型转换，只是其中也涉及到 `ToString` 的相关规则。

对大多数简单值来说，JSON 字符串化和 `toString()` 的效果基本相同，只不过序列化的结果总是字符串。见下面例子：
```js
console.log(JSON.stringify(43)) // 43
console.log(JSON.stringify('43')) // "43"
console.log(JSON.stringify(null)) // null
console.log(JSON.stringify(undefined)) // undefined，打印结果不是字符串的 undefined
console.log(JSON.stringify(false)) // false
```

